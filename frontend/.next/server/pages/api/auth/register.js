"use strict";(()=>{var e={};e.id=7,e.ids=[7],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3745:e=>{e.exports=import("firebase/app")},401:e=>{e.exports=import("firebase/auth")},1492:e=>{e.exports=import("firebase/firestore")},3392:e=>{e.exports=import("firebase/storage")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},9654:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>u,routeModule:()=>p});var i=r(1802),n=r(7153),s=r(6249),o=r(4093),c=e([o]);o=(c.then?(await c)():c)[0];let u=(0,s.l)(o,"default"),d=(0,s.l)(o,"config"),p=new i.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/auth/register",pathname:"/api/auth/register",bundlePath:"",filename:""},userland:o});a()}catch(e){a(e)}})},3255:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{I:()=>d,db:()=>p});var i=r(3745),n=r(401),s=r(1492),o=r(3392),c=e([i,n,s,o]);[i,n,s,o]=c.then?(await c)():c;let u=(0,i.initializeApp)({apiKey:"AIzaSyDHHi91_Y4X6VdqVlFoM-VFY2Gd8GIBr7M",authDomain:"trucknest-877c5.firebaseapp.com",projectId:"trucknest-877c5",storageBucket:"trucknest-877c5.firebasestorage.app",messagingSenderId:"594616293335",appId:"1:594616293335:web:ff9cf5ad981bb26f909d92"}),d=(0,n.getAuth)(u),p=(0,s.getFirestore)(u);(0,o.getStorage)(u),a()}catch(e){a(e)}})},3178:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{xv:()=>o});var i=r(3255),n=r(1492),s=e([i,n]);[i,n]=s.then?(await s)():s;let c={USERS:"users",PROPERTY_OWNERS:"property_owners",TRUCKERS:"truckers"};async function o(e,t,r){try{return await (0,n.setDoc)((0,n.doc)(i.db,c.USERS,e),{email:t.email,role:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),"property-owner"===r?await (0,n.setDoc)((0,n.doc)(i.db,c.PROPERTY_OWNERS,e),{businessName:t.businessName,phoneNumber:t.phoneNumber,address:t.address,city:t.city,state:t.state,zipCode:t.zipCode,taxId:t.taxId,bankingInfo:{accountHolder:t.accountHolder,accountNumber:t.accountNumber,routingNumber:t.routingNumber,bankName:t.bankName},verificationStatus:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}):"trucker"===r&&await (0,n.setDoc)((0,n.doc)(i.db,c.TRUCKERS,e),{firstName:t.firstName,lastName:t.lastName,phoneNumber:t.phoneNumber,address:t.address,city:t.city,state:t.state,zipCode:t.zipCode,companyName:t.companyName,vehicle:{type:t.vehicleType,dimensions:{length:t.vehicleLength,width:t.vehicleWidth,height:t.vehicleHeight},licensePlate:t.licensePlate,registrationNumber:t.registrationNumber},documents:{driversLicense:t.driversLicense,commercialLicense:t.commercialLicense,insurance:{provider:t.insuranceProvider,policyNumber:t.insurancePolicy}},verificationStatus:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),!0}catch(e){throw console.error("Error creating user profile:",e),e}}a()}catch(e){a(e)}})},4093:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>o});var i=r(3178),n=r(3255),s=e([i,n]);async function o(e,t){if("POST"!==e.method)return t.status(405).json({message:"Method not allowed"});try{let{userId:r,userData:a,role:s}=e.body,o=e.headers.authorization?.split("Bearer ")[1];if(!o)return t.status(401).json({message:"No token provided"});try{await n.I.verifyIdToken(o)}catch(e){return t.status(401).json({message:"Invalid token"})}return await (0,i.xv)(r,a,s),t.status(200).json({message:"User profile created successfully"})}catch(e){return console.error("Error in register API:",e),t.status(500).json({message:"Internal server error"})}}[i,n]=s.then?(await s)():s,a()}catch(e){a(e)}})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=9654);module.exports=r})();